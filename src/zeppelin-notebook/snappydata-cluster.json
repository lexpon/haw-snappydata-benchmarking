{"paragraphs":[{"title":"Measure SQL query runtimes","text":"%snappydata\n\n\n\n    import java.io.{BufferedWriter, FileWriter, PrintWriter}\n    import org.apache.spark.sql.{CachedDataFrame, SnappySession, SparkSession}\n    import scala.collection.mutable.ListBuffer\n    import scala.io.Source\n\n    val benchmarkFileName: String = \"/home/snappydata/benchmarks/tpcbds/queries/benchmark_queries_cleared.sql\"\n\n    val spark: SparkSession = SparkSession\n        .builder\n        .appName(\"LoadDataIntoTables\")\n        .master(\"local[*]\")\n        .getOrCreate\n\n    val snappySession: SnappySession = new SnappySession(spark.sparkContext)\n\n\n    def clearLogs(roundNumber: Int): Unit =\n    {\n        val fileNames = List(\"measure_\" + roundNumber + \".csv\", \"measure_\" + roundNumber + \"_err.csv\")\n        fileNames.foreach(fileName =>\n        {\n            val fw = new FileWriter(fileName, false)\n            val bw = new BufferedWriter(fw)\n            val out = new PrintWriter(bw)\n            out.close()\n        })\n    }\n\n\n    def writeMsgToLog(msg: String, roundNumber: Int): Unit =\n    {\n        println(msg)\n        val fw = new FileWriter(\"measure_\" + roundNumber + \".csv\", true)\n        val bw = new BufferedWriter(fw)\n        val out = new PrintWriter(bw)\n        out.println(msg)\n        out.close()\n    }\n\n\n    def writeErrToLog(err: String, roundNumber: Int): Unit =\n    {\n        println(err)\n        val fw = new FileWriter(\"measure_\" + roundNumber + \"_err.csv\", true)\n        val bw = new BufferedWriter(fw)\n        val out = new PrintWriter(bw)\n        out.println(err)\n        out.close()\n    }\n\n\n    def findSqlQueriesInFile(snappySession: SnappySession, benchmarkFileName: String): List[String] =\n    {\n        val lines = Source.fromFile(benchmarkFileName).getLines()\n        val queryBuffer: ListBuffer[String] = new ListBuffer()\n        var query: StringBuffer = new StringBuffer()\n\n        lines.foreach(line =>\n        {\n            if (line.startsWith(\"--BEGIN: QUERY\"))\n            {\n                query = new StringBuffer()\n            }\n            query.append(line)\n            query.append(\"\\n\")\n            if (line.startsWith(\"-- END: QUERY\"))\n            {\n                queryBuffer.+=(query.toString)\n            }\n        })\n\n        queryBuffer.toList\n    }\n\n\n    def parseQueryNumber(query: String, roundNumber: Int): String =\n    {\n        query.lines.foreach(line =>\n        {\n            if (line.startsWith(\"--BEGIN: QUERY\"))\n            {\n                return line.substring(line.length - 2, line.length)\n            }\n        })\n        writeErrToLog(\"could not parse query number from query: \" + query, roundNumber)\n        \"\"\n    }\n\n\n    def runSqlQuery(snappySession: SnappySession, query: String, roundNumber: Int): Unit =\n    {\n        try\n        {\n            val queryNumber: String = parseQueryNumber(query, roundNumber)\n\n            val t0 = System.nanoTime()\n            val result: CachedDataFrame = snappySession.sql(query)\n            val t1 = System.nanoTime()\n\n            val ns = t1 - t0\n            val ms = ns / 1000000\n            val s = ms / 1000\n            writeMsgToLog(queryNumber + \"; \" + ns + \"; \" + ms + \"; \" + s, roundNumber)\n        }\n        catch\n        {\n            case e: Exception =>\n                writeErrToLog(\"this query lead to an exception: \" + query, roundNumber)\n                writeErrToLog(\"exception: \" + e.toString, roundNumber\n                )\n        }\n    }\n\n\n    def runOneMeasureRound(roundNumber: Int): Unit =\n    {\n        clearLogs(roundNumber)\n        writeMsgToLog(\"query number; run time in ns; run time in ms; run time in s\", roundNumber)\n        val sqlQueryList: List[String] = findSqlQueriesInFile(snappySession, benchmarkFileName)\n        sqlQueryList.foreach(query =>\n        {\n            runSqlQuery(snappySession, query, roundNumber)\n        })\n    }\n\n\n    val numOfRounds: Int = 10\n    var curRound: Int = 1\n    while (curRound <= numOfRounds)\n    {\n        println(\"currentMeasureRound: \" + curRound)\n        runOneMeasureRound(curRound)\n        curRound = curRound + 1\n    }","user":"anonymous","dateUpdated":"2017-11-27T16:04:54+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","title":true,"editorHide":true,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1502199979404_-591639344","id":"20170808-154619_166725982","dateCreated":"2017-08-08T15:46:19+0200","dateStarted":"2017-08-21T12:27:49+0200","dateFinished":"2017-08-21T12:27:52+0200","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:342"},{"title":"Filter runnable sql benchmark queries","text":"%snappydata\n\n\n    import java.io.{BufferedWriter, FileWriter, PrintWriter}\n    import org.apache.spark.sql.{CachedDataFrame, SnappySession, SparkSession}\n    import scala.collection.mutable.ListBuffer\n    import scala.io.Source\n\n    val logFileName: String = \"RunSqlQueriesZeppelin_LOG.out\"\n    val errFileName: String = \"RunSqlQueriesZeppelin_ERR.out\"\n    val benchmarkFileName: String = \"/home/snappydata/benchmarks/tpcds/queries/benchmark_queries.sql\"\n    val clearedBenchmarkFile: String = \"/home/snappydata/benchmarks/tpcds/queries/benchmark_queries_cleared.sql\"\n\n    val spark: SparkSession = SparkSession\n        .builder\n        .appName(\"LoadDataIntoTables\")\n        .master(\"local[*]\")\n        .getOrCreate\n\n    val snappySession: SnappySession = new SnappySession(spark.sparkContext)\n\n\n    def clearLogs(): Unit =\n    {\n        val fileNames = List(logFileName, errFileName, clearedBenchmarkFile)\n        fileNames.foreach(fileName =>\n        {\n            val fw = new FileWriter(fileName, false)\n            val bw = new BufferedWriter(fw)\n            val out = new PrintWriter(bw)\n            out.println(\"\")\n            out.close()\n        })\n    }\n\n\n    def writeMsgToLog(msg: String): Unit =\n    {\n        println(msg)\n        val fw = new FileWriter(logFileName, true)\n        val bw = new BufferedWriter(fw)\n        val out = new PrintWriter(bw)\n        out.println(msg)\n        out.close()\n    }\n\n\n    def writeErrToLog(err: String): Unit =\n    {\n        println(err)\n        val fw = new FileWriter(errFileName, true)\n        val bw = new BufferedWriter(fw)\n        val out = new PrintWriter(bw)\n        out.println(err)\n        out.close()\n    }\n\n\n    def findSqlQueriesInFile(snappySession: SnappySession, benchmarkFileName: String): List[String] =\n    {\n        val lines = Source.fromFile(benchmarkFileName).getLines()\n        val queryBuffer: ListBuffer[String] = new ListBuffer()\n        var query: StringBuffer = new StringBuffer()\n\n        lines.foreach(line =>\n        {\n            if (line.startsWith(\"--BEGIN: QUERY\"))\n            {\n                query = new StringBuffer()\n            }\n            query.append(line)\n            query.append(\"\\n\")\n            if (line.startsWith(\"-- END: QUERY\"))\n            {\n                queryBuffer.+=(query.toString)\n            }\n        })\n\n        queryBuffer.toList\n    }\n\n\n    def runSqlQuery(snappySession: SnappySession, query: String): Option[String] =\n    {\n        val queriesWithoutExceptions: ListBuffer[String] = new ListBuffer()\n        try\n        {\n            val result: CachedDataFrame = snappySession.sql(query)\n            if (result.count() > 0)\n            {\n                writeMsgToLog(\"this is the result of the execution: \" + result)\n                return Some(query)\n            }\n        }\n        catch\n        {\n            case e: Exception =>\n                writeErrToLog(\"this query lead to an exception: \" + query)\n        }\n        None\n    }\n\n\n    def printSqlQueriesToFile(queries: List[String], filename: String): Unit =\n    {\n        writeMsgToLog(\"These are the cleared queries: \" + queries)\n        val fw = new FileWriter(filename, false)\n        val bw = new BufferedWriter(fw)\n        val out = new PrintWriter(bw)\n        queries.foreach(query => out.println(query))\n        out.close()\n    }\n\n\n    clearLogs()\n    val sqlQueryList: List[String] = findSqlQueriesInFile(snappySession, benchmarkFileName)\n    //writeMsgToLog(\"querys to execute: \" + sqlQueryList.toString())\n    val queriesWithoutExceptions: List[String] = sqlQueryList\n        .flatMap(query => runSqlQuery(snappySession, query))\n    writeMsgToLog(\"executed queries: \" + queriesWithoutExceptions.toString())\n    printSqlQueriesToFile(queriesWithoutExceptions, clearedBenchmarkFile)","user":"anonymous","dateUpdated":"2017-11-27T16:05:04+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","title":true,"editorHide":true,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1502179355048_1835355818","id":"20170808-100235_2049032210","dateCreated":"2017-08-08T10:02:35+0200","dateStarted":"2017-08-08T15:24:04+0200","dateFinished":"2017-08-08T15:26:41+0200","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:343"},{"title":"Create Schema","text":"%sql\n\n\n-- \n-- Legal Notice \n-- \n-- This document and associated source code (the \"Work\") is a part of a \n-- benchmark specification maintained by the TPC. \n-- \n-- The TPC reserves all right, title, and interest to the Work as provided \n-- under U.S. and international laws, including without limitation all patent \n-- and trademark rights therein. \n-- \n-- No Warranty \n-- \n-- 1.1 TO THE MAXIMUM EXTENT PERMITTED BY APPLICABLE LAW, THE INFORMATION \n--     CONTAINED HEREIN IS PROVIDED \"AS IS\" AND WITH ALL FAULTS, AND THE \n--     AUTHORS AND DEVELOPERS OF THE WORK HEREBY DISCLAIM ALL OTHER \n--     WARRANTIES AND CONDITIONS, EITHER EXPRESS, IMPLIED OR STATUTORY, \n--     INCLUDING, BUT NOT LIMITED TO, ANY (IF ANY) IMPLIED WARRANTIES, \n--     DUTIES OR CONDITIONS OF MERCHANTABILITY, OF FITNESS FOR A PARTICULAR \n--     PURPOSE, OF ACCURACY OR COMPLETENESS OF RESPONSES, OF RESULTS, OF \n--     WORKMANLIKE EFFORT, OF LACK OF VIRUSES, AND OF LACK OF NEGLIGENCE. \n--     ALSO, THERE IS NO WARRANTY OR CONDITION OF TITLE, QUIET ENJOYMENT, \n--     QUIET POSSESSION, CORRESPONDENCE TO DESCRIPTION OR NON-INFRINGEMENT \n--     WITH REGARD TO THE WORK. \n-- 1.2 IN NO EVENT WILL ANY AUTHOR OR DEVELOPER OF THE WORK BE LIABLE TO \n--     ANY OTHER PARTY FOR ANY DAMAGES, INCLUDING BUT NOT LIMITED TO THE \n--     COST OF PROCURING SUBSTITUTE GOODS OR SERVICES, LOST PROFITS, LOSS \n--     OF USE, LOSS OF DATA, OR ANY INCIDENTAL, CONSEQUENTIAL, DIRECT, \n--     INDIRECT, OR SPECIAL DAMAGES WHETHER UNDER CONTRACT, TORT, WARRANTY,\n--     OR OTHERWISE, ARISING IN ANY WAY OUT OF THIS OR ANY OTHER AGREEMENT \n--     RELATING TO THE WORK, WHETHER OR NOT SUCH AUTHOR OR DEVELOPER HAD \n--     ADVANCE NOTICE OF THE POSSIBILITY OF SUCH DAMAGES. \n-- \n-- Contributors:\n-- Gradient Systems\n--\ncreate table dbgen_version\n(\n    dv_version                varchar(16)                   ,\n    dv_create_date            date                          ,\n    dv_create_time            varchar(200)                  ,\n    dv_cmdline_args           varchar(200)                  \n)\nUSING COLUMN;\n\ncreate table customer_address\n(\n    ca_address_sk             integer               not null,\n    ca_address_id             char(16)              not null,\n    ca_street_number          char(10)                      ,\n    ca_street_name            varchar(60)                   ,\n    ca_street_type            char(15)                      ,\n    ca_suite_number           char(10)                      ,\n    ca_city                   varchar(60)                   ,\n    ca_county                 varchar(30)                   ,\n    ca_state                  char(2)                       ,\n    ca_zip                    char(10)                      ,\n    ca_country                varchar(20)                   ,\n    ca_gmt_offset             decimal(5,2)                  ,\n    ca_location_type          char(20)                      \n)\nUSING COLUMN;\n\ncreate table customer_demographics\n(\n    cd_demo_sk                integer               not null,\n    cd_gender                 char(1)                       ,\n    cd_marital_status         char(1)                       ,\n    cd_education_status       char(20)                      ,\n    cd_purchase_estimate      integer                       ,\n    cd_credit_rating          char(10)                      ,\n    cd_dep_count              integer                       ,\n    cd_dep_employed_count     integer                       ,\n    cd_dep_college_count      integer                       \n)\nUSING COLUMN;\n\ncreate table date_dim\n(\n    d_date_sk                 integer               not null,\n    d_date_id                 char(16)              not null,\n    d_date                    date                          ,\n    d_month_seq               integer                       ,\n    d_week_seq                integer                       ,\n    d_quarter_seq             integer                       ,\n    d_year                    integer                       ,\n    d_dow                     integer                       ,\n    d_moy                     integer                       ,\n    d_dom                     integer                       ,\n    d_qoy                     integer                       ,\n    d_fy_year                 integer                       ,\n    d_fy_quarter_seq          integer                       ,\n    d_fy_week_seq             integer                       ,\n    d_day_name                char(9)                       ,\n    d_quarter_name            char(6)                       ,\n    d_holiday                 char(1)                       ,\n    d_weekend                 char(1)                       ,\n    d_following_holiday       char(1)                       ,\n    d_first_dom               integer                       ,\n    d_last_dom                integer                       ,\n    d_same_day_ly             integer                       ,\n    d_same_day_lq             integer                       ,\n    d_current_day             char(1)                       ,\n    d_current_week            char(1)                       ,\n    d_current_month           char(1)                       ,\n    d_current_quarter         char(1)                       ,\n    d_current_year            char(1)                       \n)\nUSING COLUMN;\n\ncreate table warehouse\n(\n    w_warehouse_sk            integer               not null,\n    w_warehouse_id            char(16)              not null,\n    w_warehouse_name          varchar(20)                   ,\n    w_warehouse_sq_ft         integer                       ,\n    w_street_number           char(10)                      ,\n    w_street_name             varchar(60)                   ,\n    w_street_type             char(15)                      ,\n    w_suite_number            char(10)                      ,\n    w_city                    varchar(60)                   ,\n    w_county                  varchar(30)                   ,\n    w_state                   char(2)                       ,\n    w_zip                     char(10)                      ,\n    w_country                 varchar(20)                   ,\n    w_gmt_offset              decimal(5,2)                  \n)\nUSING COLUMN;\n\ncreate table ship_mode\n(\n    sm_ship_mode_sk           integer               not null,\n    sm_ship_mode_id           char(16)              not null,\n    sm_type                   char(30)                      ,\n    sm_code                   char(10)                      ,\n    sm_carrier                char(20)                      ,\n    sm_contract               char(20)                      \n)\nUSING COLUMN;\n\ncreate table time_dim\n(\n    t_time_sk                 integer               not null,\n    t_time_id                 char(16)              not null,\n    t_time                    integer                       ,\n    t_hour                    integer                       ,\n    t_minute                  integer                       ,\n    t_second                  integer                       ,\n    t_am_pm                   char(2)                       ,\n    t_shift                   char(20)                      ,\n    t_sub_shift               char(20)                      ,\n    t_meal_time               char(20)                      \n)\nUSING COLUMN;\n\ncreate table reason\n(\n    r_reason_sk               integer               not null,\n    r_reason_id               char(16)              not null,\n    r_reason_desc             char(100)                     \n)\nUSING COLUMN;\n\ncreate table income_band\n(\n    ib_income_band_sk         integer               not null,\n    ib_lower_bound            integer                       ,\n    ib_upper_bound            integer                       \n)\nUSING COLUMN;\n\ncreate table item\n(\n    i_item_sk                 integer               not null,\n    i_item_id                 char(16)              not null,\n    i_rec_start_date          date                          ,\n    i_rec_end_date            date                          ,\n    i_item_desc               varchar(200)                  ,\n    i_current_price           decimal(7,2)                  ,\n    i_wholesale_cost          decimal(7,2)                  ,\n    i_brand_id                integer                       ,\n    i_brand                   char(50)                      ,\n    i_class_id                integer                       ,\n    i_class                   char(50)                      ,\n    i_category_id             integer                       ,\n    i_category                char(50)                      ,\n    i_manufact_id             integer                       ,\n    i_manufact                char(50)                      ,\n    i_size                    char(20)                      ,\n    i_formulation             char(20)                      ,\n    i_color                   char(20)                      ,\n    i_units                   char(10)                      ,\n    i_container               char(10)                      ,\n    i_manager_id              integer                       ,\n    i_product_name            char(50)                      \n)\nUSING COLUMN;\n\ncreate table store\n(\n    s_store_sk                integer               not null,\n    s_store_id                char(16)              not null,\n    s_rec_start_date          date                          ,\n    s_rec_end_date            date                          ,\n    s_closed_date_sk          integer                       ,\n    s_store_name              varchar(50)                   ,\n    s_number_employees        integer                       ,\n    s_floor_space             integer                       ,\n    s_hours                   char(20)                      ,\n    s_manager                 varchar(40)                   ,\n    s_market_id               integer                       ,\n    s_geography_class         varchar(100)                  ,\n    s_market_desc             varchar(100)                  ,\n    s_market_manager          varchar(40)                   ,\n    s_division_id             integer                       ,\n    s_division_name           varchar(50)                   ,\n    s_company_id              integer                       ,\n    s_company_name            varchar(50)                   ,\n    s_street_number           varchar(10)                   ,\n    s_street_name             varchar(60)                   ,\n    s_street_type             char(15)                      ,\n    s_suite_number            char(10)                      ,\n    s_city                    varchar(60)                   ,\n    s_county                  varchar(30)                   ,\n    s_state                   char(2)                       ,\n    s_zip                     char(10)                      ,\n    s_country                 varchar(20)                   ,\n    s_gmt_offset              decimal(5,2)                  ,\n    s_tax_precentage          decimal(5,2)                  \n)\nUSING COLUMN;\n\ncreate table call_center\n(\n    cc_call_center_sk         integer               not null,\n    cc_call_center_id         char(16)              not null,\n    cc_rec_start_date         date                          ,\n    cc_rec_end_date           date                          ,\n    cc_closed_date_sk         integer                       ,\n    cc_open_date_sk           integer                       ,\n    cc_name                   varchar(50)                   ,\n    cc_class                  varchar(50)                   ,\n    cc_employees              integer                       ,\n    cc_sq_ft                  integer                       ,\n    cc_hours                  char(20)                      ,\n    cc_manager                varchar(40)                   ,\n    cc_mkt_id                 integer                       ,\n    cc_mkt_class              char(50)                      ,\n    cc_mkt_desc               varchar(100)                  ,\n    cc_market_manager         varchar(40)                   ,\n    cc_division               integer                       ,\n    cc_division_name          varchar(50)                   ,\n    cc_company                integer                       ,\n    cc_company_name           char(50)                      ,\n    cc_street_number          char(10)                      ,\n    cc_street_name            varchar(60)                   ,\n    cc_street_type            char(15)                      ,\n    cc_suite_number           char(10)                      ,\n    cc_city                   varchar(60)                   ,\n    cc_county                 varchar(30)                   ,\n    cc_state                  char(2)                       ,\n    cc_zip                    char(10)                      ,\n    cc_country                varchar(20)                   ,\n    cc_gmt_offset             decimal(5,2)                  ,\n    cc_tax_percentage         decimal(5,2)                  \n)\nUSING COLUMN;\n\ncreate table customer\n(\n    c_customer_sk             integer               not null,\n    c_customer_id             char(16)              not null,\n    c_current_cdemo_sk        integer                       ,\n    c_current_hdemo_sk        integer                       ,\n    c_current_addr_sk         integer                       ,\n    c_first_shipto_date_sk    integer                       ,\n    c_first_sales_date_sk     integer                       ,\n    c_salutation              char(10)                      ,\n    c_first_name              char(20)                      ,\n    c_last_name               char(30)                      ,\n    c_preferred_cust_flag     char(1)                       ,\n    c_birth_day               integer                       ,\n    c_birth_month             integer                       ,\n    c_birth_year              integer                       ,\n    c_birth_country           varchar(20)                   ,\n    c_login                   char(13)                      ,\n    c_email_address           char(50)                      ,\n    c_last_review_date        char(10)                      \n)\nUSING COLUMN;\n\ncreate table web_site\n(\n    web_site_sk               integer               not null,\n    web_site_id               char(16)              not null,\n    web_rec_start_date        date                          ,\n    web_rec_end_date          date                          ,\n    web_name                  varchar(50)                   ,\n    web_open_date_sk          integer                       ,\n    web_close_date_sk         integer                       ,\n    web_class                 varchar(50)                   ,\n    web_manager               varchar(40)                   ,\n    web_mkt_id                integer                       ,\n    web_mkt_class             varchar(50)                   ,\n    web_mkt_desc              varchar(100)                  ,\n    web_market_manager        varchar(40)                   ,\n    web_company_id            integer                       ,\n    web_company_name          char(50)                      ,\n    web_street_number         char(10)                      ,\n    web_street_name           varchar(60)                   ,\n    web_street_type           char(15)                      ,\n    web_suite_number          char(10)                      ,\n    web_city                  varchar(60)                   ,\n    web_county                varchar(30)                   ,\n    web_state                 char(2)                       ,\n    web_zip                   char(10)                      ,\n    web_country               varchar(20)                   ,\n    web_gmt_offset            decimal(5,2)                  ,\n    web_tax_percentage        decimal(5,2)                  \n)\nUSING COLUMN;\n\ncreate table store_returns\n(\n    sr_returned_date_sk       integer                       ,\n    sr_return_time_sk         integer                       ,\n    sr_item_sk                integer               not null,\n    sr_customer_sk            integer                       ,\n    sr_cdemo_sk               integer                       ,\n    sr_hdemo_sk               integer                       ,\n    sr_addr_sk                integer                       ,\n    sr_store_sk               integer                       ,\n    sr_reason_sk              integer                       ,\n    sr_ticket_number          integer               not null,\n    sr_return_quantity        integer                       ,\n    sr_return_amt             decimal(7,2)                  ,\n    sr_return_tax             decimal(7,2)                  ,\n    sr_return_amt_inc_tax     decimal(7,2)                  ,\n    sr_fee                    decimal(7,2)                  ,\n    sr_return_ship_cost       decimal(7,2)                  ,\n    sr_refunded_cash          decimal(7,2)                  ,\n    sr_reversed_charge        decimal(7,2)                  ,\n    sr_store_credit           decimal(7,2)                  ,\n    sr_net_loss               decimal(7,2)                  \n)\nUSING COLUMN;\n\ncreate table household_demographics\n(\n    hd_demo_sk                integer               not null,\n    hd_income_band_sk         integer                       ,\n    hd_buy_potential          char(15)                      ,\n    hd_dep_count              integer                       ,\n    hd_vehicle_count          integer                       \n)\nUSING COLUMN;\n\ncreate table web_page\n(\n    wp_web_page_sk            integer               not null,\n    wp_web_page_id            char(16)              not null,\n    wp_rec_start_date         date                          ,\n    wp_rec_end_date           date                          ,\n    wp_creation_date_sk       integer                       ,\n    wp_access_date_sk         integer                       ,\n    wp_autogen_flag           char(1)                       ,\n    wp_customer_sk            integer                       ,\n    wp_url                    varchar(100)                  ,\n    wp_type                   char(50)                      ,\n    wp_char_count             integer                       ,\n    wp_link_count             integer                       ,\n    wp_image_count            integer                       ,\n    wp_max_ad_count           integer                       \n)\nUSING COLUMN;\n\ncreate table promotion\n(\n    p_promo_sk                integer               not null,\n    p_promo_id                char(16)              not null,\n    p_start_date_sk           integer                       ,\n    p_end_date_sk             integer                       ,\n    p_item_sk                 integer                       ,\n    p_cost                    decimal(15,2)                 ,\n    p_response_target         integer                       ,\n    p_promo_name              char(50)                      ,\n    p_channel_dmail           char(1)                       ,\n    p_channel_email           char(1)                       ,\n    p_channel_catalog         char(1)                       ,\n    p_channel_tv              char(1)                       ,\n    p_channel_radio           char(1)                       ,\n    p_channel_press           char(1)                       ,\n    p_channel_event           char(1)                       ,\n    p_channel_demo            char(1)                       ,\n    p_channel_details         varchar(100)                  ,\n    p_purpose                 char(15)                      ,\n    p_discount_active         char(1)                       \n)\nUSING COLUMN;\n\ncreate table catalog_page\n(\n    cp_catalog_page_sk        integer               not null,\n    cp_catalog_page_id        char(16)              not null,\n    cp_start_date_sk          integer                       ,\n    cp_end_date_sk            integer                       ,\n    cp_department             varchar(50)                   ,\n    cp_catalog_number         integer                       ,\n    cp_catalog_page_number    integer                       ,\n    cp_description            varchar(100)                  ,\n    cp_type                   varchar(100)                  \n)\nUSING COLUMN;\n\ncreate table inventory\n(\n    inv_date_sk               integer               not null,\n    inv_item_sk               integer               not null,\n    inv_warehouse_sk          integer               not null,\n    inv_quantity_on_hand      integer                       \n)\nUSING COLUMN;\n\ncreate table catalog_returns\n(\n    cr_returned_date_sk       integer                       ,\n    cr_returned_time_sk       integer                       ,\n    cr_item_sk                integer               not null,\n    cr_refunded_customer_sk   integer                       ,\n    cr_refunded_cdemo_sk      integer                       ,\n    cr_refunded_hdemo_sk      integer                       ,\n    cr_refunded_addr_sk       integer                       ,\n    cr_returning_customer_sk  integer                       ,\n    cr_returning_cdemo_sk     integer                       ,\n    cr_returning_hdemo_sk     integer                       ,\n    cr_returning_addr_sk      integer                       ,\n    cr_call_center_sk         integer                       ,\n    cr_catalog_page_sk        integer                       ,\n    cr_ship_mode_sk           integer                       ,\n    cr_warehouse_sk           integer                       ,\n    cr_reason_sk              integer                       ,\n    cr_order_number           integer               not null,\n    cr_return_quantity        integer                       ,\n    cr_return_amount          decimal(7,2)                  ,\n    cr_return_tax             decimal(7,2)                  ,\n    cr_return_amt_inc_tax     decimal(7,2)                  ,\n    cr_fee                    decimal(7,2)                  ,\n    cr_return_ship_cost       decimal(7,2)                  ,\n    cr_refunded_cash          decimal(7,2)                  ,\n    cr_reversed_charge        decimal(7,2)                  ,\n    cr_store_credit           decimal(7,2)                  ,\n    cr_net_loss               decimal(7,2)                  \n)\nUSING COLUMN;\n\ncreate table web_returns\n(\n    wr_returned_date_sk       integer                       ,\n    wr_returned_time_sk       integer                       ,\n    wr_item_sk                integer               not null,\n    wr_refunded_customer_sk   integer                       ,\n    wr_refunded_cdemo_sk      integer                       ,\n    wr_refunded_hdemo_sk      integer                       ,\n    wr_refunded_addr_sk       integer                       ,\n    wr_returning_customer_sk  integer                       ,\n    wr_returning_cdemo_sk     integer                       ,\n    wr_returning_hdemo_sk     integer                       ,\n    wr_returning_addr_sk      integer                       ,\n    wr_web_page_sk            integer                       ,\n    wr_reason_sk              integer                       ,\n    wr_order_number           integer               not null,\n    wr_return_quantity        integer                       ,\n    wr_return_amt             decimal(7,2)                  ,\n    wr_return_tax             decimal(7,2)                  ,\n    wr_return_amt_inc_tax     decimal(7,2)                  ,\n    wr_fee                    decimal(7,2)                  ,\n    wr_return_ship_cost       decimal(7,2)                  ,\n    wr_refunded_cash          decimal(7,2)                  ,\n    wr_reversed_charge        decimal(7,2)                  ,\n    wr_account_credit         decimal(7,2)                  ,\n    wr_net_loss               decimal(7,2)                  \n)\nUSING COLUMN;\n\ncreate table web_sales\n(\n    ws_sold_date_sk           integer                       ,\n    ws_sold_time_sk           integer                       ,\n    ws_ship_date_sk           integer                       ,\n    ws_item_sk                integer               not null,\n    ws_bill_customer_sk       integer                       ,\n    ws_bill_cdemo_sk          integer                       ,\n    ws_bill_hdemo_sk          integer                       ,\n    ws_bill_addr_sk           integer                       ,\n    ws_ship_customer_sk       integer                       ,\n    ws_ship_cdemo_sk          integer                       ,\n    ws_ship_hdemo_sk          integer                       ,\n    ws_ship_addr_sk           integer                       ,\n    ws_web_page_sk            integer                       ,\n    ws_web_site_sk            integer                       ,\n    ws_ship_mode_sk           integer                       ,\n    ws_warehouse_sk           integer                       ,\n    ws_promo_sk               integer                       ,\n    ws_order_number           integer               not null,\n    ws_quantity               integer                       ,\n    ws_wholesale_cost         decimal(7,2)                  ,\n    ws_list_price             decimal(7,2)                  ,\n    ws_sales_price            decimal(7,2)                  ,\n    ws_ext_discount_amt       decimal(7,2)                  ,\n    ws_ext_sales_price        decimal(7,2)                  ,\n    ws_ext_wholesale_cost     decimal(7,2)                  ,\n    ws_ext_list_price         decimal(7,2)                  ,\n    ws_ext_tax                decimal(7,2)                  ,\n    ws_coupon_amt             decimal(7,2)                  ,\n    ws_ext_ship_cost          decimal(7,2)                  ,\n    ws_net_paid               decimal(7,2)                  ,\n    ws_net_paid_inc_tax       decimal(7,2)                  ,\n    ws_net_paid_inc_ship      decimal(7,2)                  ,\n    ws_net_paid_inc_ship_tax  decimal(7,2)                  ,\n    ws_net_profit             decimal(7,2)                  \n)\nUSING COLUMN;\n\ncreate table catalog_sales\n(\n    cs_sold_date_sk           integer                       ,\n    cs_sold_time_sk           integer                       ,\n    cs_ship_date_sk           integer                       ,\n    cs_bill_customer_sk       integer                       ,\n    cs_bill_cdemo_sk          integer                       ,\n    cs_bill_hdemo_sk          integer                       ,\n    cs_bill_addr_sk           integer                       ,\n    cs_ship_customer_sk       integer                       ,\n    cs_ship_cdemo_sk          integer                       ,\n    cs_ship_hdemo_sk          integer                       ,\n    cs_ship_addr_sk           integer                       ,\n    cs_call_center_sk         integer                       ,\n    cs_catalog_page_sk        integer                       ,\n    cs_ship_mode_sk           integer                       ,\n    cs_warehouse_sk           integer                       ,\n    cs_item_sk                integer               not null,\n    cs_promo_sk               integer                       ,\n    cs_order_number           integer               not null,\n    cs_quantity               integer                       ,\n    cs_wholesale_cost         decimal(7,2)                  ,\n    cs_list_price             decimal(7,2)                  ,\n    cs_sales_price            decimal(7,2)                  ,\n    cs_ext_discount_amt       decimal(7,2)                  ,\n    cs_ext_sales_price        decimal(7,2)                  ,\n    cs_ext_wholesale_cost     decimal(7,2)                  ,\n    cs_ext_list_price         decimal(7,2)                  ,\n    cs_ext_tax                decimal(7,2)                  ,\n    cs_coupon_amt             decimal(7,2)                  ,\n    cs_ext_ship_cost          decimal(7,2)                  ,\n    cs_net_paid               decimal(7,2)                  ,\n    cs_net_paid_inc_tax       decimal(7,2)                  ,\n    cs_net_paid_inc_ship      decimal(7,2)                  ,\n    cs_net_paid_inc_ship_tax  decimal(7,2)                  ,\n    cs_net_profit             decimal(7,2)                  \n)\nUSING COLUMN;\n\ncreate table store_sales\n(\n    ss_sold_date_sk           integer                       ,\n    ss_sold_time_sk           integer                       ,\n    ss_item_sk                integer               not null,\n    ss_customer_sk            integer                       ,\n    ss_cdemo_sk               integer                       ,\n    ss_hdemo_sk               integer                       ,\n    ss_addr_sk                integer                       ,\n    ss_store_sk               integer                       ,\n    ss_promo_sk               integer                       ,\n    ss_ticket_number          integer               not null,\n    ss_quantity               integer                       ,\n    ss_wholesale_cost         decimal(7,2)                  ,\n    ss_list_price             decimal(7,2)                  ,\n    ss_sales_price            decimal(7,2)                  ,\n    ss_ext_discount_amt       decimal(7,2)                  ,\n    ss_ext_sales_price        decimal(7,2)                  ,\n    ss_ext_wholesale_cost     decimal(7,2)                  ,\n    ss_ext_list_price         decimal(7,2)                  ,\n    ss_ext_tax                decimal(7,2)                  ,\n    ss_coupon_amt             decimal(7,2)                  ,\n    ss_net_paid               decimal(7,2)                  ,\n    ss_net_paid_inc_tax       decimal(7,2)                  ,\n    ss_net_profit             decimal(7,2)                  \n)\nUSING COLUMN;\n\n\n\n\n\n-- \n-- Legal Notice \n-- \n-- This document and associated source code (the \"Work\") is a part of a \n-- benchmark specification maintained by the TPC. \n-- \n-- The TPC reserves all right, title, and interest to the Work as provided \n-- under U.S. and international laws, including without limitation all patent \n-- and trademark rights therein. \n-- \n-- No Warranty \n-- \n-- 1.1 TO THE MAXIMUM EXTENT PERMITTED BY APPLICABLE LAW, THE INFORMATION \n--     CONTAINED HEREIN IS PROVIDED \"AS IS\" AND WITH ALL FAULTS, AND THE \n--     AUTHORS AND DEVELOPERS OF THE WORK HEREBY DISCLAIM ALL OTHER \n--     WARRANTIES AND CONDITIONS, EITHER EXPRESS, IMPLIED OR STATUTORY, \n--     INCLUDING, BUT NOT LIMITED TO, ANY (IF ANY) IMPLIED WARRANTIES, \n--     DUTIES OR CONDITIONS OF MERCHANTABILITY, OF FITNESS FOR A PARTICULAR \n--     PURPOSE, OF ACCURACY OR COMPLETENESS OF RESPONSES, OF RESULTS, OF \n--     WORKMANLIKE EFFORT, OF LACK OF VIRUSES, AND OF LACK OF NEGLIGENCE. \n--     ALSO, THERE IS NO WARRANTY OR CONDITION OF TITLE, QUIET ENJOYMENT, \n--     QUIET POSSESSION, CORRESPONDENCE TO DESCRIPTION OR NON-INFRINGEMENT \n--     WITH REGARD TO THE WORK. \n-- 1.2 IN NO EVENT WILL ANY AUTHOR OR DEVELOPER OF THE WORK BE LIABLE TO \n--     ANY OTHER PARTY FOR ANY DAMAGES, INCLUDING BUT NOT LIMITED TO THE \n--     COST OF PROCURING SUBSTITUTE GOODS OR SERVICES, LOST PROFITS, LOSS \n--     OF USE, LOSS OF DATA, OR ANY INCIDENTAL, CONSEQUENTIAL, DIRECT, \n--     INDIRECT, OR SPECIAL DAMAGES WHETHER UNDER CONTRACT, TORT, WARRANTY,\n--     OR OTHERWISE, ARISING IN ANY WAY OUT OF THIS OR ANY OTHER AGREEMENT \n--     RELATING TO THE WORK, WHETHER OR NOT SUCH AUTHOR OR DEVELOPER HAD \n--     ADVANCE NOTICE OF THE POSSIBILITY OF SUCH DAMAGES. \n-- \n-- Contributors:\n-- Gradient Systems\n--\n\n-- ============================================================\n--   Database name:  tpcds_source                              \n--   DBMS name:      ANSI Level 2                              \n--   Created on:     2/8/2007  9:38 AM                         \n-- ============================================================\n\n-- ============================================================\n--   Table: s_catalog_page                                     \n-- ============================================================\ncreate table s_catalog_page\n(\n    cpag_catalog_number         integer               not null,\n    cpag_catalog_page_number    integer               not null,\n    cpag_department             char(20)                      ,\n    cpag_id                     char(16)                      ,\n    cpag_start_date             char(10)                      ,\n    cpag_end_date               char(10)                      ,\n    cpag_description            varchar(100)                  ,\n    cpag_type                   varchar(100)                  \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_zip_to_gmt                                       \n-- ============================================================\ncreate table s_zip_to_gmt\n(\n    zipg_zip                    char(5)               not null,\n    zipg_gmt_offset             integer               not null\n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_purchase_lineitem                                \n-- ============================================================\ncreate table s_purchase_lineitem\n(\n    plin_purchase_id            integer               not null,\n    plin_line_number            integer               not null,\n    plin_item_id                char(16)                      ,\n    plin_promotion_id           char(16)                      ,\n    plin_quantity               integer                       ,\n    plin_sale_price             numeric(7,2)                  ,\n    plin_coupon_amt             numeric(7,2)                  ,\n    plin_comment                varchar(100)                  \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_customer                                         \n-- ============================================================\ncreate table s_customer\n(\n    cust_customer_id            char(16)              not null,\n    cust_salutation             char(10)                      ,\n    cust_last_name              char(20)                      ,\n    cust_first_name             char(20)                      ,\n    cust_preffered_flag         char(1)                       ,\n    cust_birth_date             char(10)                      ,\n    cust_birth_country          char(20)                      ,\n    cust_login_id               char(13)                      ,\n    cust_email_address          char(50)                      ,\n    cust_last_login_chg_date    char(10)                      ,\n    cust_first_shipto_date      char(10)                      ,\n    cust_first_purchase_date    char(10)                      ,\n    cust_last_review_date       char(10)                      ,\n    cust_primary_machine_id     char(15)                      ,\n    cust_secondary_machine_id   char(15)                      ,\n    cust_street_number          smallint                      ,\n    cust_suite_number           char(10)                      ,\n    cust_street_name1           char(30)                      ,\n    cust_street_name2           char(30)                      ,\n    cust_street_type            char(15)                      ,\n    cust_city                   char(60)                      ,\n    cust_zip                    char(10)                      ,\n    cust_county                 char(30)                      ,\n    cust_state                  char(2)                       ,\n    cust_country                char(20)                      ,\n    cust_loc_type               char(20)                      ,\n    cust_gender                 char(1)                       ,\n    cust_marital_status         char(1)                       ,\n    cust_educ_status            char(20)                      ,\n    cust_credit_rating          char(10)                      ,\n    cust_purch_est              numeric(7,2)                  ,\n    cust_buy_potential          char(15)                      ,\n    cust_depend_cnt             smallint                      ,\n    cust_depend_emp_cnt         smallint                      ,\n    cust_depend_college_cnt     smallint                      ,\n    cust_vehicle_cnt            smallint                      ,\n    cust_annual_income          numeric(9,2)                  \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_customer_address                                 \n-- ============================================================\ncreate table s_customer_address\n(\n    cadr_address_id             char(16)              not null,\n    cadr_street_number          integer                       ,\n    cadr_street_name1           char(25)                      ,\n    cadr_street_name2           char(25)                      ,\n    cadr_street_type            char(15)                      ,\n    cadr_suitnumber             char(10)                      ,\n    cadr_city                   char(60)                      ,\n    cadr_county                 char(30)                      ,\n    cadr_state                  char(2)                       ,\n    cadr_zip                    char(10)                      ,\n    cadr_country                char(20)                      \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_purchase                                         \n-- ============================================================\ncreate table s_purchase\n(\n    purc_purchase_id            integer               not null,\n    purc_store_id               char(16)                      ,\n    purc_customer_id            char(16)                      ,\n    purc_purchase_date          char(10)                      ,\n    purc_purchase_time          integer                       ,\n    purc_register_id            integer                       ,\n    purc_clerk_id               integer                       ,\n    purc_comment                char(100)                     \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_catalog_order                                    \n-- ============================================================\ncreate table s_catalog_order\n(\n    cord_order_id               integer               not null,\n    cord_bill_customer_id       char(16)                      ,\n    cord_ship_customer_id       char(16)                      ,\n    cord_order_date             char(10)                      ,\n    cord_order_time             integer                       ,\n    cord_ship_mode_id           char(16)                      ,\n    cord_call_center_id         char(16)                      ,\n    cord_order_comments         varchar(100)                  \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_web_order                                        \n-- ============================================================\ncreate table s_web_order\n(\n    word_order_id               integer               not null,\n    word_bill_customer_id       char(16)                      ,\n    word_ship_customer_id       char(16)                      ,\n    word_order_date             char(10)                      ,\n    word_order_time             integer                       ,\n    word_ship_mode_id           char(16)                      ,\n    word_web_site_id            char(16)                      ,\n    word_order_comments         char(100)                     \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_item                                             \n-- ============================================================\ncreate table s_item\n(\n    item_item_id                char(16)              not null,\n    item_item_description       char(200)                     ,\n    item_list_price             numeric(7,2)                  ,\n    item_wholesale_cost         numeric(7,2)                  ,\n    item_size                   char(20)                      ,\n    item_formulation            char(20)                      ,\n    item_color                  char(20)                      ,\n    item_units                  char(10)                      ,\n    item_container              char(10)                      ,\n    item_manager_id             integer                       \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_catalog_order_lineitem                           \n-- ============================================================\ncreate table s_catalog_order_lineitem\n(\n    clin_order_id               integer               not null,\n    clin_line_number            integer               not null,\n    clin_item_id                char(16)                      ,\n    clin_promotion_id           char(16)                      ,\n    clin_quantity               integer                       ,\n    clin_sales_price            numeric(7,2)                  ,\n    clin_coupon_amt             numeric(7,2)                  ,\n    clin_warehouse_id           char(16)                      ,\n    clin_ship_date              char(10)                      ,\n    clin_catalog_number         integer                       ,\n    clin_catalog_page_number    integer                       ,\n    clin_ship_cost              numeric(7,2)                  \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_web_order_lineitem                               \n-- ============================================================\ncreate table s_web_order_lineitem\n(\n    wlin_order_id               integer               not null,\n    wlin_line_number            integer               not null,\n    wlin_item_id                char(16)                      ,\n    wlin_promotion_id           char(16)                      ,\n    wlin_quantity               integer                       ,\n    wlin_sales_price            numeric(7,2)                  ,\n    wlin_coupon_amt             numeric(7,2)                  ,\n    wlin_warehouse_id           char(16)                      ,\n    wlin_ship_date              char(10)                      ,\n    wlin_ship_cost              numeric(7,2)                  ,\n    wlin_web_page_id            char(16)                      \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_store                                            \n-- ============================================================\ncreate table s_store\n(\n    stor_store_id               char(16)              not null,\n    stor_closed_date            char(10)                      ,\n    stor_name                   char(50)                      ,\n    stor_employees              integer                       ,\n    stor_floor_space            integer                       ,\n    stor_hours                  char(20)                      ,\n    stor_store_manager          char(40)                      ,\n    stor_market_id              integer                       ,\n    stor_geography_class        char(100)                     ,\n    stor_market_manager         char(40)                      ,\n    stor_tax_percentage         numeric(5,2)                  \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_call_center                                      \n-- ============================================================\ncreate table s_call_center\n(\n    call_center_id              char(16)              not null,\n    call_open_date              char(10)                      ,\n    call_closed_date            char(10)                      ,\n    call_center_name            char(50)                      ,\n    call_center_class           char(50)                      ,\n    call_center_employees       integer                       ,\n    call_center_sq_ft           integer                       ,\n    call_center_hours           char(20)                      ,\n    call_center_manager         char(40)                      ,\n    call_center_tax_percentage  numeric(7,2)                  \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_web_site                                         \n-- ============================================================\ncreate table s_web_site\n(\n    wsit_web_site_id            char(16)              not null,\n    wsit_open_date              char(10)                      ,\n    wsit_closed_date            char(10)                      ,\n    wsit_site_name              char(50)                      ,\n    wsit_site_class             char(50)                      ,\n    wsit_site_manager           char(40)                      ,\n    wsit_tax_percentage         decimal(5,2)                  \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_warehouse                                        \n-- ============================================================\ncreate table s_warehouse\n(\n    wrhs_warehouse_id           char(16)              not null,\n    wrhs_warehouse_desc         char(200)                     ,\n    wrhs_warehouse_sq_ft        integer                       \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_web_page                                         \n-- ============================================================\ncreate table s_web_page\n(\n    wpag_web_page_id            char(16)              not null,\n    wpag_create_date            char(10)                      ,\n    wpag_access_date            char(10)                      ,\n    wpag_autogen_flag           char(1)                       ,\n    wpag_url                    char(100)                     ,\n    wpag_type                   char(50)                      ,\n    wpag_char_cnt               integer                       ,\n    wpag_link_cnt               integer                       ,\n    wpag_image_cnt              integer                       ,\n    wpag_max_ad_cnt             integer                       \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_promotion                                        \n-- ============================================================\ncreate table s_promotion\n(\n    prom_promotion_id           char(16)              not null,\n    prom_promotion_name         char(30)                      ,\n    prom_start_date             char(10)                      ,\n    prom_end_date               char(10)                      ,\n    prom_cost                   numeric(7,2)                  ,\n    prom_response_target        char(1)                       ,\n    prom_channel_dmail          char(1)                       ,\n    prom_channel_email          char(1)                       ,\n    prom_channel_catalog        char(1)                       ,\n    prom_channel_tv             char(1)                       ,\n    prom_channel_radio          char(1)                       ,\n    prom_channel_press          char(1)                       ,\n    prom_channel_event          char(1)                       ,\n    prom_channel_demo           char(1)                       ,\n    prom_channel_details        char(100)                     ,\n    prom_purpose                char(15)                      ,\n    prom_discount_active        char(1)                       ,\n    prom_discount_pct           numeric(5,2)                  \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_store_returns                                    \n-- ============================================================\ncreate table s_store_returns\n(\n    sret_store_id               char(16)                      ,\n    sret_purchase_id            char(16)              not null,\n    sret_line_number            integer               not null,\n    sret_item_id                char(16)              not null,\n    sret_customer_id            char(16)                      ,\n    sret_return_date            char(10)                      ,\n    sret_return_time            char(10)                      ,\n    sret_ticket_number          char(20)                      ,\n    sret_return_qty             integer                       ,\n    sret_return_amt             numeric(7,2)                  ,\n    sret_return_tax             numeric(7,2)                  ,\n    sret_return_fee             numeric(7,2)                  ,\n    sret_return_ship_cost       numeric(7,2)                  ,\n    sret_refunded_cash          numeric(7,2)                  ,\n    sret_reversed_charge        numeric(7,2)                  ,\n    sret_store_credit           numeric(7,2)                  ,\n    sret_reason_id              char(16)                      \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_catalog_returns                                  \n-- ============================================================\ncreate table s_catalog_returns\n(\n    cret_call_center_id         char(16)                      ,\n    cret_order_id               integer               not null,\n    cret_line_number            integer               not null,\n    cret_item_id                char(16)              not null,\n    cret_return_customer_id     char(16)                      ,\n    cret_refund_customer_id     char(16)                      ,\n    cret_return_date            char(10)                      ,\n    cret_return_time            char(10)                      ,\n    cret_return_qty             integer                       ,\n    cret_return_amt             numeric(7,2)                  ,\n    cret_return_tax             numeric(7,2)                  ,\n    cret_return_fee             numeric(7,2)                  ,\n    cret_return_ship_cost       numeric(7,2)                  ,\n    cret_refunded_cash          numeric(7,2)                  ,\n    cret_reversed_charge        numeric(7,2)                  ,\n    cret_merchant_credit        numeric(7,2)                  ,\n    cret_reason_id              char(16)                      ,\n    cret_shipmode_id            char(16)                      ,\n    cret_catalog_page_id        char(16)                      ,\n    cret_warehouse_id           char(16)                      \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_web_returns                                      \n-- ============================================================\ncreate table s_web_returns\n(\n    wret_web_site_id            char(16)                      ,\n    wret_order_id               integer               not null,\n    wret_line_number            integer               not null,\n    wret_item_id                char(16)              not null,\n    wret_return_customer_id     char(16)                      ,\n    wret_refund_customer_id     char(16)                      ,\n    wret_return_date            char(10)                      ,\n    wret_return_time            char(10)                      ,\n    wret_return_qty             integer                       ,\n    wret_return_amt             numeric(7,2)                  ,\n    wret_return_tax             numeric(7,2)                  ,\n    wret_return_fee             numeric(7,2)                  ,\n    wret_return_ship_cost       numeric(7,2)                  ,\n    wret_refunded_cash          numeric(7,2)                  ,\n    wret_reversed_charge        numeric(7,2)                  ,\n    wret_account_credit         numeric(7,2)                  ,\n    wret_reason_id              char(16)                      \n)\nUSING COLUMN;\n\n-- ============================================================\n--   Table: s_inventory                                        \n-- ============================================================\ncreate table s_inventory\n(\n    invn_warehouse_id           char(16)              not null,\n    invn_item_id                char(16)              not null,\n    invn_date                   char(10)              not null,\n    invn_qty_on_hand            integer                       \n)\nUSING COLUMN;\n\n","user":"anonymous","dateUpdated":"2017-10-19T09:11:37+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","editorHide":true,"title":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1500906573809_1460602047","id":"20170724-162933_457984139","dateCreated":"2017-07-24T16:29:33+0200","dateStarted":"2017-09-16T10:54:30+0200","dateFinished":"2017-09-16T10:56:02+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:346","focus":true},{"title":"Load Data Into Tables","text":"%snappydata\n\n\n    import java.io.{BufferedWriter, FileWriter, PrintWriter}\n    import org.apache.spark.sql.{SnappySession, SparkSession}\n    import scala.collection.mutable.LinkedHashMap\n\n    /*\n        make definitions\n    */\n    val baseFolder: String = \"/home/snappydata/benchmarks/tpcds/75_GB/\"\n\n    val fileMap: LinkedHashMap[String, String] = LinkedHashMap(\n        \"call_center.dat\" -> \"call_center\",\n        \"catalog_page.dat\" -> \"catalog_page\",\n        \"catalog_returns.dat\" -> \"catalog_returns\",\n        \"catalog_sales.dat\" -> \"catalog_sales\",\n        \"customer.dat\" -> \"customer\",\n        \"customer_address.dat\" -> \"customer_address\",\n        \"customer_demographics.dat\" -> \"customer_demographics\",\n        \"date_dim.dat\" -> \"date_dim\",\n        \"dbgen_version.dat\" -> \"dbgen_version\",\n        \"household_demographics.dat\" -> \"household_demographics\",\n        \"income_band.dat\" -> \"income_band\",\n        \"inventory.dat\" -> \"inventory\",\n        \"item.dat\" -> \"item\",\n        \"promotion.dat\" -> \"promotion\",\n        \"reason.dat\" -> \"reason\",\n        \"ship_mode.dat\" -> \"ship_mode\",\n        \"store.dat\" -> \"store\",\n        \"store_returns.dat\" -> \"store_returns\",\n        \"store_sales.dat\" -> \"store_sales\",\n        \"time_dim.dat\" -> \"time_dim\",\n        \"warehouse.dat\" -> \"warehouse\",\n        \"web_page.dat\" -> \"web_page\",\n        \"web_returns.dat\" -> \"web_returns\",\n        \"web_sales.dat\" -> \"web_sales\",\n        \"web_site.dat\" -> \"web_site\"\n    )\n\n    val spark: SparkSession = SparkSession\n        .builder\n        .appName(\"LoadDataIntoTables\")\n        .master(\"local[*]\")\n        .getOrCreate\n\n    val snappySession: SnappySession = new SnappySession(spark.sparkContext)\n\n\n    /*\n        necessary methods\n     */\n    def writeMsgToLog(msg: String): Unit =\n    {\n        println(msg)\n        val fw = new FileWriter(\"LoadDataIntoTablesZeppelin_LOG.out\", true)\n        val bw = new BufferedWriter(fw)\n        val out = new PrintWriter(bw)\n        out.println(msg)\n        out.close()\n    }\n\n\n    def writeErrToLog(err: String): Unit =\n    {\n        println(err)\n        val fw = new FileWriter(\"LoadDataIntoTablesZeppelin_ERROR.out\", true)\n        val bw = new BufferedWriter(fw)\n        val out = new PrintWriter(bw)\n        out.println(err)\n        out.close()\n    }\n\n\n    def loadDataIntoTable(snappySession: SnappySession, filePath: String, tableName: String): Unit =\n    {\n        val tableSchema = snappySession.table(tableName).schema\n        val customerDF = snappySession.read\n            .schema(schema = tableSchema)\n            .format(\"com.databricks.spark.csv\")\n            .option(\"header\", \"false\")\n            .option(\"delimiter\", \"|\")\n            .csv(filePath)\n\n        try\n        {\n            val dataframe = customerDF.write\n            writeMsgToLog(\"customerDF.write works. will now try dataframe.insertInto(\" + tableName + \")\")\n            dataframe.insertInto(tableName)\n            writeMsgToLog(\"dataframe.insertInto(\" + tableName + \") worked\")\n        }\n        catch\n        {\n            case e: Exception => writeErrToLog(\"could not write dataframe to table. table: \" + tableName + \"; dataframe: \" + customerDF\n                .toString() + \"; Exception: \" + e)\n        }\n    }\n\n\n    def loadDataIntoDataStore(\n        snappySession: SnappySession,\n        baseFolder: String,\n        fileMap: LinkedHashMap[String, String]): Any =\n    {\n        fileMap.foreach\n        { keyVal =>\n            val filePath: String = baseFolder + keyVal._1\n            val tableName: String = keyVal._2\n\n            writeMsgToLog(\"try to load data from file '\" + filePath + \"' into table '\" + tableName + \"'\")\n\n            try\n            {\n                loadDataIntoTable(snappySession, filePath, tableName)\n            }\n            catch\n            {\n                case e: Exception => writeErrToLog(\"Exception occured: \" + e.getMessage + \" - Exception: \" + e.toString)\n            }\n        }\n    }\n\n\n    /*\n        RUN THE JOB\n    */\n    loadDataIntoDataStore(snappySession, baseFolder, fileMap)","user":"anonymous","dateUpdated":"2017-10-19T09:12:04+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","title":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1501740073516_1115946470","id":"20170803-080113_2023424812","dateCreated":"2017-08-03T08:01:13+0200","dateStarted":"2017-09-16T10:57:23+0200","dateFinished":"2017-09-16T11:35:53+0200","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:345"},{"title":"Delete schema","text":"%sql\n\nDROP TABLE IF EXISTS \"dbgen_version\";\n","user":"anonymous","dateUpdated":"2017-09-01T15:19:51+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","editorHide":true,"title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1500906465212_-252897993","id":"20170724-162745_1515646539","dateCreated":"2017-07-24T16:27:45+0200","dateStarted":"2017-08-31T15:30:15+0200","dateFinished":"2017-08-31T15:30:19+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:347"},{"text":"","user":"anonymous","dateUpdated":"2017-08-03T08:09:01+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500907814223_90318578","id":"20170724-165014_1699006871","dateCreated":"2017-07-24T16:50:14+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:348"}],"name":"SnappyData-Cluster","id":"2CNXX3V9W","angularObjects":{"2CQJCTSE5:shared_process":[],"2CPBVTH9Q:shared_process":[],"2CQDDTVUJ:shared_process":[],"2CNC8K1UP:shared_process":[],"2CP9VWA8E:shared_process":[],"2CQZUMNM9:shared_process":[],"2CRJV2HZP:shared_process":[],"2CN66E9GV:shared_process":[],"2CQ16B8ZU:shared_process":[],"2CMWDPA3Y:shared_process":[],"2CN3STQKG:shared_process":[],"2CNHASPNT:shared_process":[],"2CPCJBXD8:shared_process":[],"2CPEDR9BW:shared_process":[],"2CRAMBT2U:shared_process":[],"2CPY6VQ99:shared_process":[],"2CPQ2HVPP:shared_process":[],"2CRED81X7:shared_process":[],"2CP1AXVQ7:shared_process":[],"2CQJ6UH2Z:existing_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}